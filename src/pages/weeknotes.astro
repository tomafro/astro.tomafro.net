---
import MainLayout from "@layouts/MainLayout.astro";
import Article from "@components/Article.astro";
import { weeknotes } from "@lib/collections.js";

const rendered = await Promise.all(
  weeknotes
    .wherePublished()
    .byMostRecent()
    .map(async (weeknote) => {
      const { Content, headings } = await weeknote.render();
      return { weeknote, Content, headings };
    })
);
---

<MainLayout title="Weeknotes">
  {
    rendered.map(({ weeknote, Content, headings }) => {
      return (
        <Article article={weeknote}>
          <Content />
        </Article>
      );
    })
  }
</MainLayout>
